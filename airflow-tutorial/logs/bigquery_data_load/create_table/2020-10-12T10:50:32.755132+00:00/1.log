[2020-10-12 16:20:55,581] {taskinstance.py:669} INFO - Dependencies all met for <TaskInstance: bigquery_data_load.create_table 2020-10-12T10:50:32.755132+00:00 [queued]>
[2020-10-12 16:20:55,593] {taskinstance.py:669} INFO - Dependencies all met for <TaskInstance: bigquery_data_load.create_table 2020-10-12T10:50:32.755132+00:00 [queued]>
[2020-10-12 16:20:55,593] {taskinstance.py:879} INFO - 
--------------------------------------------------------------------------------
[2020-10-12 16:20:55,593] {taskinstance.py:880} INFO - Starting attempt 1 of 1
[2020-10-12 16:20:55,593] {taskinstance.py:881} INFO - 
--------------------------------------------------------------------------------
[2020-10-12 16:20:55,669] {taskinstance.py:900} INFO - Executing <Task(BigQueryOperator): create_table> on 2020-10-12T10:50:32.755132+00:00
[2020-10-12 16:20:55,676] {standard_task_runner.py:53} INFO - Started process 186813 to run task
[2020-10-12 16:20:55,825] {logging_mixin.py:112} INFO - Running %s on host %s <TaskInstance: bigquery_data_load.create_table 2020-10-12T10:50:32.755132+00:00 [running]> ludicxx
[2020-10-12 16:20:55,837] {bigquery_operator.py:252} INFO - Executing: 
    SELECT * except (rank)
    FROM (
        SELECT 
            *,
            ROW_NUMBER() OVER (
                PARTITION BY vehicle_id ORDER BY DATETIME(date, TIME(hour, minute, 0)) DESC
            ) as rank
        FROM 'vg-airflow-tutorial-demo.vechicle_analytics.history') as latest
    WHERE rank = 1;
    
[2020-10-12 16:20:57,855] {taskinstance.py:1145} ERROR - BigQuery job failed. Final error was: {'reason': 'invalidQuery', 'location': 'query', 'message': "Syntax error: Unexpected string literal 'vg-airflow-tutorial-demo.vechicle_analytics.history' at [9:14]"}. The job was: {'kind': 'bigquery#job', 'etag': 'LbUORSkajbPXUwTRZxTn8Q==', 'id': 'vg-airflow-tutorial-demo:asia-south1.job__GGHUKJEhxhLb0vzItJ7fZruBeSc', 'selfLink': 'https://bigquery.googleapis.com/bigquery/v2/projects/vg-airflow-tutorial-demo/jobs/job__GGHUKJEhxhLb0vzItJ7fZruBeSc?location=asia-south1', 'user_email': 'airflow-tutorial@vg-airflow-tutorial-demo.iam.gserviceaccount.com', 'configuration': {'query': {'query': "\n    SELECT * except (rank)\n    FROM (\n        SELECT \n            *,\n            ROW_NUMBER() OVER (\n                PARTITION BY vehicle_id ORDER BY DATETIME(date, TIME(hour, minute, 0)) DESC\n            ) as rank\n        FROM 'vg-airflow-tutorial-demo.vechicle_analytics.history') as latest\n    WHERE rank = 1;\n    ", 'destinationTable': {'projectId': 'vg-airflow-tutorial-demo', 'datasetId': 'vechicle_analytics', 'tableId': 'latest'}, 'createDisposition': 'CREATE_IF_NEEDED', 'writeDisposition': 'WRITE_TRUNCATE', 'priority': 'INTERACTIVE', 'allowLargeResults': False, 'useLegacySql': False}, 'jobType': 'QUERY'}, 'jobReference': {'projectId': 'vg-airflow-tutorial-demo', 'jobId': 'job__GGHUKJEhxhLb0vzItJ7fZruBeSc', 'location': 'asia-south1'}, 'statistics': {'creationTime': '1602499857306', 'startTime': '1602499857378', 'endTime': '1602499857378'}, 'status': {'errorResult': {'reason': 'invalidQuery', 'location': 'query', 'message': "Syntax error: Unexpected string literal 'vg-airflow-tutorial-demo.vechicle_analytics.history' at [9:14]"}, 'errors': [{'reason': 'invalidQuery', 'location': 'query', 'message': "Syntax error: Unexpected string literal 'vg-airflow-tutorial-demo.vechicle_analytics.history' at [9:14]"}], 'state': 'DONE'}}
Traceback (most recent call last):
  File "/home/ludicxx/anaconda3/envs/airflow-tutorial/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 983, in _run_raw_task
    result = task_copy.execute(context=context)
  File "/home/ludicxx/anaconda3/envs/airflow-tutorial/lib/python3.7/site-packages/airflow/contrib/operators/bigquery_operator.py", line 279, in execute
    encryption_configuration=self.encryption_configuration
  File "/home/ludicxx/anaconda3/envs/airflow-tutorial/lib/python3.7/site-packages/airflow/contrib/hooks/bigquery_hook.py", line 910, in run_query
    return self.run_with_configuration(configuration)
  File "/home/ludicxx/anaconda3/envs/airflow-tutorial/lib/python3.7/site-packages/airflow/contrib/hooks/bigquery_hook.py", line 1344, in run_with_configuration
    format(job['status']['errorResult'], job))
Exception: BigQuery job failed. Final error was: {'reason': 'invalidQuery', 'location': 'query', 'message': "Syntax error: Unexpected string literal 'vg-airflow-tutorial-demo.vechicle_analytics.history' at [9:14]"}. The job was: {'kind': 'bigquery#job', 'etag': 'LbUORSkajbPXUwTRZxTn8Q==', 'id': 'vg-airflow-tutorial-demo:asia-south1.job__GGHUKJEhxhLb0vzItJ7fZruBeSc', 'selfLink': 'https://bigquery.googleapis.com/bigquery/v2/projects/vg-airflow-tutorial-demo/jobs/job__GGHUKJEhxhLb0vzItJ7fZruBeSc?location=asia-south1', 'user_email': 'airflow-tutorial@vg-airflow-tutorial-demo.iam.gserviceaccount.com', 'configuration': {'query': {'query': "\n    SELECT * except (rank)\n    FROM (\n        SELECT \n            *,\n            ROW_NUMBER() OVER (\n                PARTITION BY vehicle_id ORDER BY DATETIME(date, TIME(hour, minute, 0)) DESC\n            ) as rank\n        FROM 'vg-airflow-tutorial-demo.vechicle_analytics.history') as latest\n    WHERE rank = 1;\n    ", 'destinationTable': {'projectId': 'vg-airflow-tutorial-demo', 'datasetId': 'vechicle_analytics', 'tableId': 'latest'}, 'createDisposition': 'CREATE_IF_NEEDED', 'writeDisposition': 'WRITE_TRUNCATE', 'priority': 'INTERACTIVE', 'allowLargeResults': False, 'useLegacySql': False}, 'jobType': 'QUERY'}, 'jobReference': {'projectId': 'vg-airflow-tutorial-demo', 'jobId': 'job__GGHUKJEhxhLb0vzItJ7fZruBeSc', 'location': 'asia-south1'}, 'statistics': {'creationTime': '1602499857306', 'startTime': '1602499857378', 'endTime': '1602499857378'}, 'status': {'errorResult': {'reason': 'invalidQuery', 'location': 'query', 'message': "Syntax error: Unexpected string literal 'vg-airflow-tutorial-demo.vechicle_analytics.history' at [9:14]"}, 'errors': [{'reason': 'invalidQuery', 'location': 'query', 'message': "Syntax error: Unexpected string literal 'vg-airflow-tutorial-demo.vechicle_analytics.history' at [9:14]"}], 'state': 'DONE'}}
[2020-10-12 16:20:57,862] {taskinstance.py:1202} INFO - Marking task as FAILED.dag_id=bigquery_data_load, task_id=create_table, execution_date=20201012T105032, start_date=20201012T105055, end_date=20201012T105057
[2020-10-12 16:21:05,419] {logging_mixin.py:112} INFO - [2020-10-12 16:21:05,418] {local_task_job.py:103} INFO - Task exited with return code 1
